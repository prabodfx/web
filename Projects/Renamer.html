<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/../Projects/fc/Renamer/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/../Projects/fc/Renamer/favicon.svg" />
    <link rel="shortcut icon" href="/../Projects/fc/Renamer/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/../Projects/fc/Renamer/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Renamer" />
    <link rel="manifest" href="/../Projects/fc/Renamer/site.webmanifest" />
    <title>Renamer | Prabodfx</title>
    <style>
        /* CSS for 'Premium Look' and Layout */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6; /* Light gray background */
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
            text-align: center;
            position: relative;
            min-height: 400px;
        }

        h1 {
            color: #1a73e8; /* Google Blue */
            margin-bottom: 20px;
            font-size: 1.8em;
            padding-bottom: 10px;
        }

        h2 {
            color: #555;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .section {
            position: absolute;
            top: 130px; 
            left: 40px;
            right: 40px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            width: calc(100% - 80px);
        }

        .section.active {
            opacity: 1;
            visibility: visible;
        }

        .button-grid {
            display: grid;
            gap: 15px;
            grid-template-columns: 1fr 1fr;
        }

        /* Default Button Style */
        .copy-btn {
            background-color: #1a73e8; /* Default Blue */
            color: white;
            border: none;
            padding: 15px 10px;
            font-size: 1em;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .copy-btn:hover:not(.marked) {
            background-color: #155cb0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .copy-btn:active {
            transform: translateY(1px);
        }

        /* Marked Button Style */
        .copy-btn.marked {
            background-color: #02fa2c; /* Vibrant Green for marked */
            color: #333;
            box-shadow: 0 4px 10px rgba(2, 250, 44, 0.4);
            font-weight: bold;
        }

        .copy-btn.marked:hover {
            background-color: #00e627; /* Slightly darker green on hover */
        }
        
        /* Message Area above sections (used only for reserving space, if needed) */
        .message-top {
            min-height: 18px; /* Reserve space */
            margin-bottom: 10px;
            opacity: 0; /* Hide the old message area */
        }

        .help-text {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            font-size: 0.8em;
            color: #999;
        }
        
        .help-text span {
            font-weight: bold;
            color: #1a73e8;
        }
        
        /* NEW: Premium Fixed Message Bar at the Bottom */
        #bottom-message-bar {
            position: fixed;
            bottom: -60px; /* Start off-screen */
            left: 50%;
            transform: translateX(-50%);
            background-color: #333; /* Dark background */
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            font-size: 1em;
            z-index: 1000;
            opacity: 0;
            transition: bottom 0.4s ease-out, opacity 0.4s ease-out;
            min-width: 300px;
            text-align: center;
        }

        #bottom-message-bar.show {
            bottom: 20px; /* Slide up into view */
            opacity: 1;
        }

        #bottom-message-bar .status-icon {
            margin-right: 8px;
            font-weight: bold;
        }

        .message-success {
            color: #4CAF50; /* Green for success */
        }
        
        .message-remove {
            color: #FF9800; /* Orange/Amber for removal */
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>Clipboard Utility üìã</h1>
        <div class="message-top" id="message-top"></div> <div class="section active" id="section-1">
            <h2>Report & List (Billing)</h2>
            <div class="button-grid" id="button-container-1">
            </div>
        </div>

        <div class="section" id="section-2">
            <h2>Inventory & Outstanding (Stock)</h2>
            <div class="button-grid" id="button-container-2">
            </div>
        </div>
        
        <p class="help-text">Press <span>SPACEBAR</span> to switch sections. 
        | <span>Right-Click</span> a button to remove the mark.</p>
    </div>

    <div id="bottom-message-bar"></div>


    <script>
        
        const sections = [
            {
                id: 'section-1',
                texts: [
                    "BILL LIST KATUWANA", "BILL LIST EMBILIPITIYA",
                    "SALES REPORT KATUWANA", "SALES REPORT EMBILIPITIYA",
                    "RECIEPT LIST KATUWANA", "RECIEPT LIST EMBILIPITIYA",
                    "GRN KATUWANA", "GRN EMBILIPITIYA"
                ]
            },
            {
                id: 'section-2',
                texts: [
                    "OUTSTANDING KATUWANA", "OUTSTANDING EMBILIPITIYA",
                    "STOCK REPORT KATUWANA", "STOCK REPORT EMBILIPITIYA",
                ]
            }
        ];

        let currentSectionIndex = 0; 
        const messageBar = document.getElementById('bottom-message-bar');
        const localStorageKey = 'clipboardUtilityClickedButtons';

        let clickedStates = {}; 
        
        // --- Utility Functions ---

        function getCurrentDateFormatted() {
            const now = new Date();
            const dateOnlyFormat = `${now.toLocaleString('en-US', { month: 'short' }).toUpperCase()}-${String(now.getDate()).padStart(2, '0')}`;
            return `@${dateOnlyFormat}`;
        }
        
        function getCurrentDateOnly() {
            const now = new Date();
            return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
        }

        const dateSuffix = getCurrentDateFormatted(); 
        const currentDateOnly = getCurrentDateOnly();


        // Function to display premium message at the bottom
        function showPremiumMessage(message, type) {
            let icon = '';
            let colorClass = '';

            if (type === 'copy') {
                icon = '‚úÖ';
                colorClass = 'message-success';
            } else if (type === 'remove') {
                icon = '‚ùå';
                colorClass = 'message-remove';
            } else {
                icon = '‚ÑπÔ∏è';
                colorClass = '';
            }

            messageBar.innerHTML = `<span class="status-icon ${colorClass}">${icon}</span> ${message}`;
            messageBar.classList.add('show');

            // Clear the message after 3 seconds
            clearTimeout(window.messageTimeout);
            window.messageTimeout = setTimeout(() => {
                messageBar.classList.remove('show');
            }, 3000);
        }


        // --- Local Storage Management ---

        function loadClickedStates() {
            const storedData = localStorage.getItem(localStorageKey);
            if (storedData) {
                try {
                    const data = JSON.parse(storedData);
                    if (data && data.date === currentDateOnly) {
                        clickedStates = data.states || {};
                    } else {
                        localStorage.removeItem(localStorageKey);
                        clickedStates = {};
                    }
                } catch (e) {
                    console.error("Error parsing localStorage data:", e);
                    localStorage.removeItem(localStorageKey);
                    clickedStates = {};
                }
            }
        }

        function saveClickedStates() {
            const dataToStore = {
                date: currentDateOnly,
                states: clickedStates
            };
            localStorage.setItem(localStorageKey, JSON.stringify(dataToStore));
        }

        // --- Button Creation and Interaction ---

        function handleRightClick(event) {
            // Check if the event target is a button
            if (!event.target.classList.contains('copy-btn')) return;

            event.preventDefault(); // Prevents the browser's default context menu
            const buttonElement = event.target;
            const buttonKey = buttonElement.getAttribute('data-key');

            if (!buttonElement.classList.contains('marked')) {
                // If not marked, just show a message and stop
                showPremiumMessage(`Mark already removed from: ${buttonElement.textContent}`, 'remove');
                return;
            }

            // 1. Remove the marked class
            buttonElement.classList.remove('marked');
            
            // 2. Remove the state from the tracking object
            delete clickedStates[buttonKey];
            
            // 3. Persist the change
            saveClickedStates();

            // 4. Provide visual feedback (temporary flash of the default blue color)
            buttonElement.style.backgroundColor = '#1a73e8'; // Default Blue
            setTimeout(() => {
                buttonElement.style.backgroundColor = ''; // Revert to CSS default (which is #1a73e8)
            }, 500);

            // 5. Display the premium message
            showPremiumMessage(`Mark removed from: ${buttonElement.textContent}`, 'remove');
        }

        function copyText(buttonElement) {
            const textToCopy = buttonElement.getAttribute('data-copy-text');
            const buttonKey = buttonElement.getAttribute('data-key');

            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    
                    // Mark the button as clicked for the day
                    buttonElement.classList.add('marked');
                    clickedStates[buttonKey] = true;
                    saveClickedStates(); 

                    // Brief visual feedback on the button (quick flash of success color)
                    buttonElement.style.backgroundColor = '#4CAF50'; // Bright Green Success
                    setTimeout(() => {
                        // Restore the 'marked' color (Vibrant Green)
                        buttonElement.style.backgroundColor = '#02fa2c'; 
                    }, 500);

                    // Display the premium message
                    showPremiumMessage(`Copied: ${textToCopy}`, 'copy');
                })
                .catch(err => {
                    console.error('Could not copy text: ', err);
                    showPremiumMessage('Error: Could not copy text. Manual copy required.', 'error');
                });
        }
        
        function createButtons() {
            loadClickedStates(); 

            sections.forEach((sectionData, sectionIndex) => {
                const buttonContainer = document.getElementById(`button-container-${sectionIndex + 1}`);
                buttonContainer.innerHTML = '';
                
                sectionData.texts.forEach((text, textIndex) => {
                    const button = document.createElement('button');
                    const fullText = text + " " + dateSuffix;
                    const buttonKey = `sec-${sectionIndex}-btn-${textIndex}`; 

                    button.className = 'copy-btn';
                    button.textContent = fullText;
                    button.setAttribute('data-copy-text', fullText);
                    button.setAttribute('data-key', buttonKey);
                    
                    button.onclick = () => copyText(button); 
                    button.oncontextmenu = handleRightClick; 

                    // Apply the 'marked' class if it was clicked today
                    if (clickedStates[buttonKey]) {
                        button.classList.add('marked');
                    }

                    buttonContainer.appendChild(button);
                });
            });
        }
        
        // Initial button creation
        createButtons();


        // --- Section Switching ---

        function toggleSection() {
            const oldSection = document.getElementById(sections[currentSectionIndex].id);
            oldSection.classList.remove('active');

            currentSectionIndex = (currentSectionIndex + 1) % sections.length;

            const newSection = document.getElementById(sections[currentSectionIndex].id);
            newSection.classList.add('active');
            
            // Ensure any existing message is cleared when switching sections
            clearTimeout(window.messageTimeout);
            messageBar.classList.remove('show');
        }
        
        // --- Event Listeners ---
        
        // Keyboard Listener for Spacebar
        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space' || event.key === ' ') {
                event.preventDefault(); 
                toggleSection();
            }
        });

    </script>
</body>
</html>